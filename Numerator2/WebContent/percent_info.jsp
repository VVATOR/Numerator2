<%@ page language="java" contentType="text/html; charset=windows-1251"
    pageEncoding="windows-1251"%>
<%@page import="OracleConnect.SQLRequest" import="NumGenerator.NumGenerate" import="java.util.*"%>
<%@page import="java.net.URLEncoder"%>
<%@page import="java.net.URLDecoder"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<style type="text/css" title="currentStyle">
	@import "css/demo_page.css";
	@import "css/demo_table.css";
</style>
<script type="text/javascript" language="JavaScript">
 function changeImg1(source)
 {  
	 document.pict1.src = source + '.PNG';
 };
</script>
<title>оНДПНАМЮЪ ЯРЮРХЯРХЙЮ ОН СГКС</title>
<%
//ОЕПЕЛЕММШЕ ДКЪ ПЮГАХЮЕМХЪ ЯРПНЙХ
String delimiter = " ";
String[] temp;
String ExplodedOBOZ="";
NumGenerate num = new NumGenerate();
//---------------------------------
String OBOZ_PREFIX = "";
String OBOZ_FIRST_NUM = "";
String OBOZ_SECOND_NUM = "";
String OBOZ_THERD_NUM = "";
String OBOZ_POSTFIX = "";
String Type = "";
SQLRequest sql = new SQLRequest();
String SessionUser = "";
if(session.getAttribute("SessionUser") != null) SessionUser = session.getAttribute("SessionUser").toString();			//ОНКЭГНБЮРЕКЭ ЯЕЯЯХХ
String FULLNAME = "";
if(session.getAttribute("FULLNAME") != null) FULLNAME = session.getAttribute("FULLNAME").toString();					//тхн
String DEPARTMENT = "";
if(session.getAttribute("DEPARTMENT") != null) DEPARTMENT = session.getAttribute("DEPARTMENT").toString();				//нРДЕК
String SelectedItem="";
if(request.getParameter("SelectedItem") != null)
	 SelectedItem = new String (request.getParameter("SelectedItem").getBytes("ISO-8859-1"));
%>
</head>
<body id="dt_example"  background="images/background.png">
	<div class="full_width big" align=center>оНДПНАМЮЪ ЯРЮРХЯРХЙЮ ОН СГКС</div>
	<a href="index.jsp?SelectedItem=<%=URLEncoder.encode(SelectedItem,"windows-1251")%>"><img name=pict1 border=0 src="images/BUTTON_LEFT.PNG" onMouseOver="changeImg1('images/BUTTON_LEFT_SELECTED')" onMouseOut="changeImg1('images/BUTTON_LEFT')"></a>
	<%
	//оепелеммше дкъ нрверю
	int VSEGO_ASM = 0;
	int VSEGO_PRT= 0;
	int VSEGO = 0;
	int VSEGO_ASM_A4 = 0;
	int VSEGO_PRT_A4= 0;
	int VSEGO_A4 = 0;
	//------
	int RAZRAB_ASM = 0;
	int RAZRAB_PRT = 0;
	int RAZRAB_VSEGO = 0;
	int RAZRAB_ASM_A4 = 0;
	int RAZRAB_PRT_A4 = 0;
	int RAZRAB_VSEGO_A4 = 0;
	//------
	int OSTALOS_ASM = 0;
	int OSTALOS_PRT = 0;
	int OSTALOS_VSEGO = 0;
	int OSTALOS_ASM_A4 = 0;
	int OSTALOS_PRT_A4 = 0;
	int OSTALOS_VSEGO_A4 = 0;
	//------
	int ERROR_ASM_A4 = 0;
	int ERROR_PRT_A4 = 0;
	if(!SelectedItem.equals("")){
						sql.GetTreeForOBOZ(SelectedItem);
						while(sql.rs.next()){
							if(sql.rs.getString("OBOZ_THERD_NUM").charAt(sql.rs.getString("OBOZ_THERD_NUM").length()-1) == '0'){
								//--------------------------------------------------
								//                        яанпйх
								//--------------------------------------------------
								//бяецн яанпнй
								VSEGO_ASM++;
								//бяецн яанпнй ю4
								try{
									VSEGO_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 	
									ERROR_ASM_A4++;
								}
								//--------------------------------------------------
								//           б гюбхяхлнярх нр ярюрсяю
								//--------------------------------------------------
								switch(sql.rs.getInt("STATUS_ID")){
								case 1:
									//яанпнй ярюкняэ
									OSTALOS_ASM++;
									//яанпнй нярюкняэ ю4
									try{
										OSTALOS_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 2: 
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 3:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 4:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 6:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 7: 
									//яанпнй нярюкняэ
									OSTALOS_ASM++;
									//яанпнй нярюкняэ ю4
									try{
										OSTALOS_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 8:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 9:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 10:  
									//яанпнй пюгпюанрюмн
									RAZRAB_ASM++;
									//яанпнй пюгпюанрюмн ю4
									try{
										RAZRAB_ASM_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								}
								//--------------------------------------------------
							}
							else{
								//--------------------------------------------------
								//                        дерюкх
								//--------------------------------------------------
								//бяецн дерюкеи
								VSEGO_PRT++;
								//бяецн дерюкеи ю4
								try{
									VSEGO_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 
									ERROR_PRT_A4++;
								}
								//--------------------------------------------------
								//           б гюбхяхлнярх нр ярюрсяю
								//--------------------------------------------------
								switch(sql.rs.getInt("STATUS_ID")){
								case 1:
									//дерюкеиярюкняэ
									OSTALOS_PRT++;
									//дерюкеинярюкняэ ю4
									try{
										OSTALOS_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 2: 
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 3:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 4:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 6:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 7: 
									//дерюкеинярюкняэ
									OSTALOS_PRT++;
									//дерюкеинярюкняэ ю4
									try{
										OSTALOS_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 8:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 9:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								case 10:  
									//дерюкеипюгпюанрюмн
									RAZRAB_PRT++;
									//дерюкеипюгпюанрюмн ю4
									try{
										RAZRAB_PRT_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
									}	
									catch (Exception e){ 		
									}
									break;
								}
								//--------------------------------------------------
							}
							//бяецн
							VSEGO++;
							//бяецн ю4
							try{
								VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
							}	
							catch (Exception e){ 		
							}
							//--------------------------------------------------
							//           б гюбхяхлнярх нр ярюрсяю
							//--------------------------------------------------
							switch(sql.rs.getInt("STATUS_ID")){
							case 1:
								//бяецн ярюкняэ
								OSTALOS_VSEGO++;
								//бяецн нярюкняэ ю4
								try{
									OSTALOS_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 2: 
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 3:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 4:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 6:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 7: 
								//бяецн нярюкняэ
								OSTALOS_VSEGO++;
								//бяецн нярюкняэ ю4
								try{
									OSTALOS_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 8:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 9:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							case 10:  
								//бяецн пюгпюанрюмн
								RAZRAB_VSEGO++;
								//бяецн пюгпюанрюмн ю4
								try{
									RAZRAB_VSEGO_A4 += Integer.parseInt(sql.rs.getString("A4_COUNT"));
								}	
								catch (Exception e){ 		
								}
								break;
							}
							//--------------------------------------------------
						}
	}
	%>
	<h1>бЯЕЦН</h1>
	<br><font color="#6495ED">яАНПНЙ: </font><%=VSEGO_ASM%> <font color="#6495ED"> ХГ </font><%=VSEGO%> 
	<% 
		if(VSEGO != 0) {
			out.println("<font color=\"#6495ED\">(" + VSEGO_ASM*100/VSEGO + "%)</font>");
		}
	%>
	<br><font color="#6495ED">дЕРЮКЕИ: </font><%=VSEGO_PRT%> <font color="#6495ED"> ХГ </font><%=VSEGO%>
	<% 
		if(VSEGO != 0) {
			out.println("<font color=\"#6495ED\">(" + VSEGO_PRT*100/VSEGO + "%)</font>");
		}
	%>
	<br><font color="#6495ED">бЯЕЦН: </font><%=VSEGO%>
	<br>
	<br><font color="#6495ED">яАНПНЙ Б ю4:</font><%=VSEGO_ASM_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_A4%>
	<% 
		if(VSEGO_ASM_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + VSEGO_ASM_A4*100/VSEGO_A4 + "%)</font>");
		}
		if(ERROR_ASM_A4 > 0){
			out.println("<font color=\"#FF0000\"> ! " + ERROR_ASM_A4 + " ХГ " + VSEGO_ASM_A4 + " ЙНКХВЕЯБН ТНПЛЮРНБ ю4 ДКЪ ЯАНПНЙ МЕ СДЮКНЯЭ НОПЕДЕКХРЭ. оНЦПЕЬМНЯРЭ ЯНЯРЮБХР: " + ERROR_ASM_A4*100/VSEGO_ASM_A4 + "%</font>");
		}
	%>
	<br><font color="#6495ED">дЕРЮКЕИ Б ю4:</font><%=VSEGO_PRT_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_A4%>
	<% 
		if(VSEGO_PRT_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + VSEGO_PRT_A4*100/VSEGO_A4 + "%)</font>");
		}
		if(ERROR_PRT_A4 > 0){
			out.println("<font color=\"#FF0000\"> ! " + ERROR_PRT_A4 + " ХГ " + VSEGO_PRT_A4 + " ЙНКХВЕЯБН ТНПЛЮРНБ ю4 ДКЪ ДЕРЮКЕИ МЕ СДЮКНЯЭ НОПЕДЕКХРЭ. оНЦПЕЬМНЯРЭ ЯНЯРЮБХР: " + ERROR_PRT_A4*100/VSEGO_PRT_A4 + "%</font>");
		}
	%>
	<br><font color="#6495ED">бЯЕЦН Б ю4:</font><%=VSEGO_A4%>
	<h1>пЮГПЮАНРЮМН</h1>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ ЯАНПНЙ:</font><%=RAZRAB_ASM%> <font color="#6495ED"> ХГ </font><%=VSEGO_ASM%>
	<% 
		if(VSEGO_ASM != 0) {
			out.println("<font color=\"#6495ED\">(" + RAZRAB_ASM*100/VSEGO_ASM + "%)</font>");
			if((RAZRAB_ASM*100/VSEGO_ASM) == 100)
				out.println("<font color=\"#008080\"> - ГЮБЕПЬЕМН</font>");
			else
				out.println("<font color=\"#FF0000\"> - МЕ ГЮБЕПЬЕМН</font>");
		}
	%>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ ДЕРЮКЕИ:</font><%=RAZRAB_PRT%> <font color="#6495ED"> ХГ </font><%=VSEGO_PRT%>
	<% 
		if(VSEGO_PRT != 0) {
			out.println("<font color=\"#6495ED\">(" + RAZRAB_PRT*100/VSEGO_PRT + "%)</font>");
			if((RAZRAB_PRT*100/VSEGO_PRT) == 100)
				out.println("<font color=\"#008080\"> - ГЮБЕПЬЕМН</font>");
			else
				out.println("<font color=\"#FF0000\"> - МЕ ГЮБЕПЬЕМН</font>");
		}
	%>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ БЯЕЦН:</font><%=RAZRAB_VSEGO%>
	<br>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ ЯАНПНЙ Б ю4:</font><%=RAZRAB_ASM_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_ASM_A4%>
	<% 
		if(VSEGO_ASM_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + RAZRAB_ASM_A4*100/VSEGO_ASM_A4 + "%)</font>");
		}
	%>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ ДЕРЮКЕИ Б ю4:</font><%=RAZRAB_PRT_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_PRT_A4%>
	<% 
		if(VSEGO_PRT_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + RAZRAB_PRT_A4*100/VSEGO_PRT_A4 + "%)</font>");
		}
	%>
	<br><font color="#6495ED">пЮГПЮАНРЮМН ВЕПРЕФЕИ БЯЕЦН Б ю4:</font><%=RAZRAB_VSEGO_A4%>
	<h1>нЯРЮКНЯЭ</h1>
	<br><font color="#6495ED">нЯРЮКНЯЭ ЯАНПНЙ:</font><%=OSTALOS_ASM%><font color="#6495ED"> ХГ </font><%=VSEGO_ASM%>
	<% 
		if(VSEGO_ASM != 0) {
			out.println("<font color=\"#6495ED\">(" + OSTALOS_ASM*100/VSEGO_ASM + "%)</font>");
		}
	%>
	<br><font color="#6495ED">нЯРЮКНЯЭ ДЕРЮКЕИ:</font><%=OSTALOS_PRT%><font color="#6495ED"> ХГ </font><%=VSEGO_PRT%>
	<% 
		if(VSEGO_PRT != 0) {
			out.println("<font color=\"#6495ED\">(" + OSTALOS_PRT*100/VSEGO_PRT + "%)</font>");
		}
	%>
	<br><font color="#6495ED">нЯРЮКНЯЭ БЯЕЦН:</font><%=OSTALOS_VSEGO%>
	<br>
	<br><font color="#6495ED">нЯРЮКНЯЭ ЯАНПНЙ Б ю4:</font><%=OSTALOS_ASM_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_ASM_A4%>
	<% 
		if(VSEGO_ASM_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + OSTALOS_ASM_A4*100/VSEGO_ASM_A4 + "%)</font>");
		}
	%>
	<br><font color="#6495ED">нЯРЮКНЯЭ ДЕРЮКЕИ Б ю4:</font><%=OSTALOS_PRT_A4%><font color="#6495ED"> ХГ </font><%=VSEGO_PRT_A4%>
	<% 
		if(VSEGO_ASM_A4 != 0) {
			out.println("<font color=\"#6495ED\">(" + OSTALOS_PRT_A4*100/VSEGO_ASM_A4 + "%)</font>");
		}
	sql.Disconnect();
	%>
	<br><font color="#6495ED">нЯРЮКНЯЭ БЯЕЦН Б ю4:</font><%=OSTALOS_VSEGO_A4%>
	<h1>хРНЦН БПЕЛЕМХ</h1>
	<br><font color="#6495ED">мЮ ЯАНПЙХ (МЮ АЕКНЙ):</font><%=VSEGO_ASM*30/8*0.7*0.4%>
	<br><font color="#6495ED">мЮ ЯАНПЙХ (МЮ ЙЮКЭЙС):</font><%=(30/8*0.3*VSEGO_ASM + (VSEGO_ASM*30/8*0.7*0.4))%>
	<br><font color="#6495ED">мЮ ДЕРЮКХ (МЮ АЕКНЙ):</font><%=VSEGO_PRT*30/8*0.7*0.4%>
	<br><font color="#6495ED">мЮ ДЕРЮКХ (МЮ ЙЮКЭЙС):</font><%=(30/8*0.3*VSEGO_PRT + (VSEGO_PRT*30/8*0.7*0.4))%>
	<br><font color="#6495ED">мЮ ЯАНПЙХ НР АЕКЙЮ ДН ЙЮКЭЙХ:</font><%=(30/8*0.3*VSEGO_ASM + (VSEGO_ASM*30/8*0.7*0.4)) - VSEGO_ASM*30/8*0.7*0.4%>
	<br><font color="#6495ED">мЮ ЯАНПЙХ НР АЕКЙЮ ДН ЙЮКЭЙХ:</font><%=(30/8*0.3*VSEGO_PRT + (VSEGO_PRT*30/8*0.7*0.4)) - VSEGO_PRT*30/8*0.7*0.4%>
</body>
</html>